
This part is almost an entire copy/paste of Part 2.

So, copy/paste all of the code over: the parser is still good, and it's nice
to have the `def f(st_idx, st_idx1, st_idxN):` from last time easily viewable.


