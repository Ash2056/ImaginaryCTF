
# nc oreos.imaginaryctf.org 6789 < <(echo -e '1\n')
flag_enc = 0x4d3a49da12a3321b0b7e16ac82d9825ed4f27ad0694857c43522e5e5b0f256f00a725a186adc783bb0b68908ab029018c56678e4b8b8a830fdfc8789478bd4fa679bd46320449d776cd87bfa9c644175bf699ba407b8447a96a7dba749dc3a1f2fde69d0bdd2f8bff0b77a349749ec53a8dc1509dec91aff2ae5f8f83d9ef924a39d4f00fdf7cb8cc46bbf010717d50f072f6ef8061430e4fd2f497503ee700e977f1f3f11c8b982cba098a28daa7c8f67280decb52eb146dbcbcc9efb776452dfd1cbc2dd246a35e373e543ce234d3cb9731bc293ab46e33aff3a332726098eaab985e573a77db102f9e56448bbbd21744bec26ace5bdc1aa6d8d893da3da9a
e = 65537
n = 0x967ae702a5fefbed4923f890d4e1661627b31c502ad3d4f751c5cf69e51594e6e180b1528f6db17c98a3518cc985178384ac492f82d81af7de9516a39c252de3d8c8e22e9470d6e4bcc69d516800238d5073d48987526daa52922c00f47b0f5c050ea984317b6578e0dde0601daa67018cf9b52f83ba3bf2d86748f15425769eb461d860507f18e28fdacefcbb7005450e2853686bf3709a73c055a23db79bd8c95e0a744ba7954b919566c5e0f29dccc7b262fd8e0ebed29123fcca9667814010b2db11d3b876483980f5fdcae32a45af01f44a504d33f2cde28c26d7f01daaca021140949377c22a81cfae85c9cd8520e3a5bff180a63f2059b7eb80449cf1

two_enc = pow(2, e, n)
prod_enc = (flag_enc * two_enc) % n
print(prod_enc)

# nc oreos.imaginaryctf.org 6789 < <(echo -e '3\n{prod_enc}\n')
prod_dec = 0xd2c6e8ccf6f260eabeda80c866be5642dadaf2bec6e4f2bef260eabe66ec4262bed080c6d666e4fa

print(bytes.fromhex((hex(prod_dec//2)[2:])).decode())
